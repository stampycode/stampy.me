In November 2015 I noticed that Microsoft Office 365's calendar sharing option used an HTTP permalink.

<a href="/wp-content/uploads/2016/04/Selection_007.png" rel="attachment wp-att-407"><img src="/wp-content/uploads/2016/04/Selection_007.png" alt="the calendar link shown in Office365 settings is a HTTP link, not HTTPS" width="1341" height="453" class="aligncenter size-full wp-image-407" /></a>

I reported this to Microsoft, and they have since fixed the issue. __The rest of this article was written before the issue had been fully resolved.__

<h2>what is the issue?</h2>

Before December 2016, the "share calendar" link Office 365 was giving to users to access their calendars is a bog-standard HTTP GET request permalink to your calendar, which, depending on your settings, can be used by anyone who has the link, to access:
<ul>
<li>all of your calendar details</li>
<li>some of your calendar details</li>
<li>just your availability</li>
<li>or nothing</li>
</ul>

If, like me, you use your calendar for work, to organise and attend video-conferences, online meetings, or discuss anything sensitive, then you will probably at some point have URLs, usernames, passwords, conference IDs, VOIP call numbers and passwords, within the details of your calendar appointments.

If your calendar sharing option is set to "Full Details", then anyone with the generated URL can get full read-only access to your entire calendar, and also access to all of these details.

<i>The above is all expected behaviour</i>, because you're supposed to keep the URL secret - the problem is that <u><b>the generated URL is not prefixed with HTTPS....</b></u> <i>(at least it didn't used to be.)</i>

So all the standard <abbr title="Man in the Middle">MITM</abbr> attack stuff applies - anyone with access to see any raw otherwise unprotected network traffic between your browser and the Microsoft Office 365 server will be able to see the content of this GET request.

Microsoft have even done 99% of the work required to fix this issue - when the link is accessed, the following happens:

<a href="/wp-content/uploads/2016/04/Selection_010.png" rel="attachment wp-att-408"><img src="/wp-content/uploads/2016/04/Selection_010.png" alt="shows the HTTP request being redirected to HTTPS" width="792" height="362" class="aligncenter size-full wp-image-408" /></a>

So the request is immediately upgraded to HTTPS using a `301 Moved Permanently` response, with exactly the same URL content.

But the problem is that the GET request has <b>already been sent over HTTP</b>, which contains the secret permalink key (which I have redacted) that you need in order to access the data. Even though an attacker wouldn't be able to see the second request being made or the content being downloaded over HTTPS, they could just follow the HTTPS redirect themselves to see the content, and then repeat that request when they want to see your latest calendar content.

There is no tracking available through Office 365 to see what devices are using this link, how often, where from, or anything of that nature. It also doesn't give you the option of resetting the link in case you think someone else might have gotten access to it.

At some point between November 2015 and April 2016, Microsoft have changed the default links being generated, so they default to HTTPS - but this still leaves any existing links vulnerable, and <u>Microsoft haven't informed users of the problem</u> (to my knowledge).

<h2>what can i do?</h2>

If the link in your calendar sharing settings begins with `HTTP://`, then do this:

<ol>
<li>Disable calendar sharing completely</li>
<li>Save the changes</li>
<li>Re-load the options window</li>
<li>Re-enable calendar sharing</li>
</ol>

Your link will now be different, and the old link will now be dead.

<h2>so what did Microsoft do?</h2>

They changed all new links to be HTTPS instead of HTTP, but they didn't change any existing links, or provide a nice easy button to press to do this.

<h2>what does the content of an ics file look like anyway?</h2>

ICS files just contains structured plaintext. So your usernames, passwords, phone numbers, email addresses, dates, times and locations are all sent in a very easy to read format. Any typical off-the-shelf network traffic scanning tool will be able to easily pick out your sensitive information from the data for later <strike>ab</strike>use.


